<!DOCTYPE html>
<html>
  <head>
    <title>correlation chicken COOL WEBSITE</title>
    <link rel="stylesheet" href="styling.css">
  </head>
  <body>
    <img src="https://img.notionusercontent.com/s3/prod-files-secure%2F162de1ce-4ef6-4b38-9274-feebf34c7ae8%2F86714d46-ee01-44a4-808c-de890b31052b%2Fcorrelation_chicken.png/size/w=2000?exp=1763407370&sig=3-LveE7wNgi6bio2YQ7x4jjpde9eQiBNWRwWQ5OXDgw&id=28b58b89-752d-8014-a7d3-ce22d60eb99a&table=block&userId=89a31ac8-67d7-477c-a081-084223763526">
    
    <h1>i'll style this later <s>(maybe)</s> (definitely!)</h1>
    
    <div id="mainbodytext">
      <p>if you're a TRUE correlation chicken member, go ahead and put the name of the code (eg. 'rit1q1', 'rit1q2' etc) and the challenge-specific key</p>
    
      <input type="text" id="nameinput" placeholder="input name here...">
      <input type="text" id="keyinput" placeholder="input key here...">
    
      <button id="activateScript">submit</button>
    
      <p>if it's correct, the code will appear below:</p>
    </div>
    
    <pre><code id="thething"></code></pre>

    <script>
      function decrypt(encodedcode, key) {
        // safety(copy+paste) unbase64
        encodedcode = window.atob(encodedcode)
      
        // now time to apply 'vinegar'
        var endstr = ""
        for (i = 0; i < encodedcode.length; i++) {
          var unicoderesult = (encodedcode.charCodeAt(i) - key.charCodeAt(i % key.length)) % 256
          endstr += String.fromCharCode(unicoderesult)
        }
      
        // unbase64
        endstr = window.atob(endstr)
      
        return endstr
      }
      
      document.getElementById('activateScript').addEventListener('click', function() {
        const name = document.getElementById('nameinput').value
        let encodedcode = "" // fetched in a moment
        const key = document.getElementById('keyinput').value
        const maybecodehtml = document.getElementById('thething')
        
        // crazy api stuff
        async function loadcode() {
          try {
            const response = await fetch(`https://raw.githubusercontent.com/alakazamburger/leftangle/main/${name}.txt`)
            encodedcode = await response.text()
            console.log("code loaded: ", encodedcode)
    
            const maybecode = decrypt(encodedcode, key)
            maybecodehtml.innerHTML = maybecode
            
          } catch (err) {
            console.error("error loading code: ", err)
          }
        }

        // call the crazy api stuff (and the rest of the code)
        loadcode()
      })
    </script>
  </body>
</html>
